<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>用户注册 - 河南数字文旅</title>
    <link href="css/zhuce.css" rel="stylesheet" type="text/css">
    <!-- 提前定义工具函数（兼容ES5） -->
    <script type="text/javascript">
        // 清除错误提示的通用函数（ES5语法）
        function clearError(element) {
            var errorId = "";
            if (element.id) {
                errorId = element.id + "Error";
            } else if (element.name === "interests") {
                errorId = "interestsError";
            }
            var errorTip = document.getElementById(errorId);
            if (errorTip) {
                errorTip.textContent = "";
            }
        }
    </script>
</head>
<body>
    <!-- 头部导航（替换HTML5语义标签为div，适配Dreamweaver） -->
    <div class="hand">
        <div class="title">
            <div class="hand-title">
                <img src="images/logo.png" alt="河南旅游logo" class="logo" width="50" height="50" />
                <p><i class="title_i">逐鹿中原</i> -- 河南行</p>
            </div>
        </div>
        <!-- 导航栏 -->
        <div class="nav-wrap">
            <ul class="nav-list">
                <li><a href="index.html">首页</a></li>
                <li><a href="h1.html">文旅资源</a></li>
                <li><a href="h2.html">非遗文化</a></li>
                <li><a href="h3.html">特色民俗</a></li>
                <li><a href="h4.html">数字文旅体验</a></li>
                <li><a href="video.html">视频欣赏</a></li>
            </ul>
        </div>
    </div>

    <!-- 注册主容器 -->
    <div class="register-main">
        <div class="register-container">
            <!-- 注册标题区 -->
            <h1 class="register-title">用户注册</h1>
            <hr class="title-line" />

            <!-- 注册须知 -->
            <div class="notice-section">
                <h2 class="section-subtitle">注册须知</h2>
                <table class="notice-table" border="0" cellpadding="8" cellspacing="0">
                    <tr>
                        <th class="table-header">项目</th>
                        <th class="table-header">说明</th>
                    </tr>
                    <tr>
                        <td>用户名</td>
                        <td>长度为3-8位，仅含字母、数字、下划线</td>
                    </tr>
                    <tr>
                        <td>手机号</td>
                        <td>必须为11位有效手机号码</td>
                    </tr>
                    <tr>
                        <td>密码</td>
                        <td>长度为8-16位，必须包含字母、数字（强密码需加特殊字符）</td>
                    </tr>
                </table>
            </div>

            <!-- 注册表单 -->
            <div class="form-section">
                <form id="registerForm" class="register-form" onsubmit="return validateForm()" method="post">
                    <!-- 1. 用户名 -->
                    <div class="form-group">
                        <label for="username">用户名:</label>
                        <input type="text" id="username" name="username" required />
                        <span class="error-tip" id="usernameError"></span>
                    </div>

                    <!-- 2. 手机号 -->
                    <div class="form-group">
                        <label for="phone">手机号:</label>
                        <input type="tel" id="phone" name="phone" required />
                        <span class="error-tip" id="phoneError"></span>
                    </div>

                    <!-- 3. 密码 -->
                    <div class="form-group">
                        <label for="password">密码:</label>
                        <input type="password" id="password" name="password" required />
                        <span class="error-tip" id="passwordError"></span>
                        <div class="password-strength" id="strengthIndicator">
                            <div class="strength-bar" id="bar1"></div>
                            <div class="strength-bar" id="bar2"></div>
                            <div class="strength-bar" id="bar3"></div>
                            <span id="strengthText">密码强度</span>
                        </div>
                    </div>

                    <!-- 4. 确认密码 -->
                    <div class="form-group">
                        <label for="confirmPassword">确认密码:</label>
                        <input type="password" id="confirmPassword" name="confirmPassword" required />
                        <span class="error-tip" id="confirmError"></span>
                    </div>

                    <!-- 5. 性别 -->
                    <div class="form-group">
                        <label>性别:</label>
                        <label class="radio-label">
                            <input type="radio" name="gender" value="male" checked="checked" /> 男
                        </label>
                        <label class="radio-label">
                            <input type="radio" name="gender" value="female" /> 女
                        </label>
                        <span class="error-tip" id="genderError"></span>
                    </div>

                    <!-- 6. 兴趣爱好 -->
                    <div class="form-group">
                        <label>旅游兴趣:</label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="interests" value="nature" /> 自然风光
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="interests" value="culture" /> 文化古迹
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="interests" value="food" /> 美食体验
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" name="interests" value="adventure" /> 探险
                        </label>
                        <span class="error-tip" id="interestsError"></span>
                    </div>

                    <!-- 7. 旅游偏好 -->
                    <div class="form-group">
                        <label for="preference">旅游偏好:</label>
                        <select id="preference" name="preference" required="required">
                            <option value="">请选择</option>
                            <option value="relax">休闲度假</option>
                            <option value="study">研学旅行</option>
                            <option value="adventure">探险之旅</option>
                            <option value="culture">文化体验</option>
                            <option value="food">美食之旅</option>
                        </select>
                        <span class="error-tip" id="preferenceError"></span>
                    </div>

                    <!-- 8. 个人简介 -->
                    <div class="form-group">
                        <label for="introduction">个人简介:</label>
                        <textarea id="introduction" name="introduction" rows="4" placeholder="请简要介绍自己"></textarea>
                    </div>

                    <!-- 提交按钮 -->
                    <div class="form-group btn-group">
                        <button type="submit" class="submit-btn">注册</button>
                        <button type="reset" class="reset-btn">重置</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- 底部容器 -->
    <div id="footer-container"></div>

    <!-- 脚本加载区（全ES5语法，适配Dreamweaver CS6） -->
    <script src="javaScript/load-html.js" type="text/javascript"></script>
    <script type="text/javascript">
        // 统一的页面加载完成逻辑（兼容IE/Dreamweaver）
        window.onload = function() {
            // 加载底部
            if (typeof loadFooter === 'function') {
                loadFooter('footer-container');
            } else {
                console.warn('加载底部失败：未找到loadFooter函数');
            }

            // 密码强度检测
            var passwordInput = document.getElementById('password');
            if (passwordInput) {
                passwordInput.oninput = function() {
                    var password = this.value;
                    var bar1 = document.getElementById('bar1');
                    var bar2 = document.getElementById('bar2');
                    var bar3 = document.getElementById('bar3');
                    var strengthText = document.getElementById('strengthText');
                    
                    // 重置强度指示
                    bar1.style.backgroundColor = '#ddd';
                    bar2.style.backgroundColor = '#ddd';
                    bar3.style.backgroundColor = '#ddd';
                    strengthText.textContent = '密码强度';
                    
                    if (password.length < 8) { // 匹配注册须知的8位要求
                        strengthText.textContent = '密码太短（需8位以上）';
                        return;
                    }
                    
                    // 密码强度判断（匹配注册须知）
                    var strength = 1;
                    if (/[a-zA-Z]/.test(password) && /\d/.test(password)) {
                        strength = 2;
                    }
                    if (/[a-zA-Z]/.test(password) && /\d/.test(password) && /[^a-zA-Z0-9]/.test(password)) {
                        strength = 3;
                    }
                    
                    // 更新强度显示
                    var colors = ['#ff4444', '#ffdd44', '#44dd44'];
                    var texts = ['弱', '中', '强'];
                    // 兼容循环（替换forEach）
                    var bars = [bar1, bar2, bar3];
                    for (var i = 0; i < bars.length; i++) {
                        if (i < strength) {
                            bars[i].style.backgroundColor = colors[i];
                        }
                    }
                    strengthText.textContent = '密码强度：' + texts[strength-1];
                };
            }

            // 表单提交增强验证
            var registerForm = document.getElementById('registerForm');
            if (registerForm) {
                registerForm.onsubmit = function(e) {
                    // 阻止默认提交（兼容IE）
                    if (e) {
                        e.preventDefault();
                    } else {
                        window.event.returnValue = false;
                    }
                    
                    if (!validateForm()) {
                        return false;
                    }
                    
                    // 性别二次验证
                    var gender = document.querySelector('input[name="gender"]:checked');
                    var genderError = document.getElementById('genderError');
                    if (!gender) {
                        genderError.textContent = '请选择性别！';
                        alert('请选择性别！');
                        return false;
                    } else {
                        genderError.textContent = '';
                    }

                    // 模拟注册成功
                    alert('注册成功！用户名：' + document.getElementById('username').value);
                    this.reset();
                    return false; // 仅演示，实际项目需移除
                };
            }
        };

        // 完整表单验证主函数（全ES5）
        function validateForm() {
            var isValid = true;
            var username = document.getElementById('username').value;
            var phone = document.getElementById('phone').value;
            var password = document.getElementById('password').value;
            var confirmPassword = document.getElementById('confirmPassword').value;
            var interests = document.querySelectorAll('input[name="interests"]:checked');
            var preference = document.getElementById('preference').value;

            // 1. 用户名验证（匹配注册须知：3-8位，字母/数字/下划线）
            var usernameError = document.getElementById('usernameError');
            var usernameReg = /^[a-zA-Z0-9_]{3,8}$/;
            if (!usernameReg.test(username)) {
                usernameError.textContent = '用户名需3-8位，仅含字母、数字、下划线';
                isValid = false;
            } else {
                clearError(document.getElementById('username'));
            }

            // 2. 手机号验证
            var phoneError = document.getElementById('phoneError');
            var phoneReg = /^1[3-9]\d{9}$/;
            if (!phoneReg.test(phone)) {
                phoneError.textContent = '请输入正确的11位手机号';
                isValid = false;
            } else {
                clearError(document.getElementById('phone'));
            }

            // 3. 密码验证（匹配注册须知：8-16位）
            var passwordError = document.getElementById('passwordError');
            if (password.length < 8 || password.length > 16) {
                passwordError.textContent = '密码需8-16位';
                isValid = false;
            } else {
                clearError(document.getElementById('password'));
            }

            // 4. 确认密码验证
            var confirmError = document.getElementById('confirmError');
            if (confirmPassword !== password) {
                confirmError.textContent = '两次密码不一致';
                isValid = false;
            } else {
                clearError(document.getElementById('confirmPassword'));
            }

            // 5. 兴趣爱好验证
            var interestsError = document.getElementById('interestsError');
            if (interests.length === 0) {
                interestsError.textContent = '请至少选择一项兴趣爱好';
                isValid = false;
            } else {
                clearError({name: 'interests'});
            }

            // 6. 旅游偏好验证
            var preferenceError = document.getElementById('preferenceError');
            if (!preference) {
                preferenceError.textContent = '请选择旅游偏好';
                isValid = false;
            } else {
                clearError(document.getElementById('preference'));
            }

            return isValid;
        }
    </script>
</body>
</html>